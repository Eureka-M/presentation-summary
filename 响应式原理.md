## 响应式原理

### 什么是响应式

数据变化，页面自动发生变化

可以看一下下面这个列子：

```
<div id="app">
    <div>
        <span>单价 {{ price }}</span>
        <button @click="changePrice">+1</button>
    </div>
    <div>
        <span>数量 {{ number }}</span>
        <button @click="changeNumber">+1</button>
    </div>
    <div>
        <span>应付</span>
        <span>{{ price }} * {{ number }} = {{ price * number }}</span>
    </div>
</div>
<script src="../vue.js"></script>
    <script>
        var vm = new Vue({
            el: '#app',
            data: function() {
                return {
                    price: 2,
                    number: 3
                }
            },
            methods: {
                changePrice() {
                    this.price++
                },
                changeNumber() {
                    this.number++
                }
            }
        })
```

可以看到，我们仅仅是在按钮点击的时候对 data 做一次+1 的操作，但是此时页面自动的发生了变化。

对比普通的 js

```
let price = 2
let number = 3
let pay = price * number
console.log(pay) // 6
price = 4 // 改变数据
console.log(pay) // 6 未发生变化
```

可以发现，如果我们想要 pay 发生变化，需要再次执行一下 price \* number。

> 所以，vue 帮助了我们操作了什么呢？

    1. 更新页面上的price/number值
    2. 自动计算pay值且更新页面

### 如何实现响应式

> 需要考虑一下几点

-   如何劫持数据的变化（数据劫持）
-   收集视图依赖的数据（收集依赖）
-   通知依赖更新视图（发布订阅者模式）

> 什么是订阅者模式？

是一种设计模式，公众号就是一种典型使用了该设计模式的平台。对某个公众号感兴趣的人订阅该公众号，当公众号有新的内容时，向订阅者推送内容。

> 为什么要使用订阅者模式？

如果数据发生变化之后不通知相关视图，那么视图如何知道自己需要更新呢？只能视图不断拉取数据，显然，订阅者模式更加节约性能。
